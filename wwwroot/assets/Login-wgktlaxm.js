import{r as c,l as S,p as _,j as I,o as x,c as N,e as h,u as L,b as m,d as o,q as T,w as C,h as b,f,v as w,s as M,x as O,a as V,_ as j}from"./index-B3BHKLRW.js";import{a as A}from"./index-Dq7h7Pqt.js";import{N as E}from"./NavbarHome-B_xzC9lf.js";function P(t){try{return t?JSON.parse(t):null}catch{return null}}const u=c(typeof window<"u"?localStorage.getItem("token"):null),d=c(typeof window<"u"?P(localStorage.getItem("usuario")):null);_(u,t=>{typeof window<"u"&&(t?localStorage.setItem("token",t):localStorage.removeItem("token"))});_(d,t=>{typeof window<"u"&&(t?localStorage.setItem("usuario",JSON.stringify(t)):localStorage.removeItem("usuario"))});function q(){const t=S();function g(s){u.value=s.token,d.value=s.usuario,localStorage.setItem("token",s.token),localStorage.setItem("usuario",JSON.stringify(s.usuario))}function a(){u.value=null,d.value=null,localStorage.removeItem("token"),localStorage.removeItem("usuario")}function n(){a(),t.push("/login")}function i(){return!!u.value&&!!d.value}return{token:u,usuario:d,loginSuccess:g,logout:n,clearAuth:a,isLoggedIn:i}}const z={key:0,class:"app-container"},B={class:"login-container"},J={class:"mystical-card"},U={class:"input-group"},D={class:"input-group"},F={class:"login-footer"},H=I({__name:"Login",setup(t){const{loginSuccess:g,isLoggedIn:a}=q(),n=c(""),i=c(""),s=S(),y="https://lecturasdjazz-api.onrender.com",v=c(!1);x(()=>{a()&&(console.log("ðŸŸ¢ Ya logueado, redirigiendo a /usuario"),s.replace("/usuario"))});async function k(){if(!v.value){v.value=!0;try{const l=await A.post(`${y}/api/auth/login`,{telefono:n.value,password:i.value}),{token:e,usuario:p}=l.data;e&&p?(g({token:e,usuario:p}),console.log("âœ… Login exitoso. Token guardado:",e),await new Promise(r=>setTimeout(r,100)),s.replace("/usuario")):alert("Inicio de sesiÃ³n fallido: falta token o informaciÃ³n de usuario.")}catch(l){alert(l?.response?.data?.message||"Error al iniciar sesiÃ³n"),console.error(l)}finally{v.value=!1}}}return(l,e)=>{const p=M("router-link");return L(a)()?h("",!0):(V(),N("div",z,[m(E),o("div",B,[o("div",J,[e[7]||(e[7]=T('<div class="title-wrapper" data-v-26d565bc><h1 class="main-title" data-v-26d565bc>Acceso MÃ­stico</h1><div class="golden-divider" data-v-26d565bc></div><h2 class="subtitle" data-v-26d565bc>Conecta con tu energÃ­a interior</h2></div><div class="login-animation" data-v-26d565bc><div class="crystal-ball" data-v-26d565bc><div class="inner-glow" data-v-26d565bc></div></div><p class="animation-text" data-v-26d565bc>El universo espera tu regreso</p></div>',2)),o("form",{onSubmit:C(k,["prevent"]),class:"login-form"},[o("div",U,[e[2]||(e[2]=o("label",{for:"telefono"},[o("span",{class:"detail-icon"},"ðŸ“ž"),f(" TelÃ©fono ")],-1)),b(o("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>n.value=r),type:"text",id:"telefono",class:"login-input",required:"",placeholder:"Telefono"},null,512),[[w,n.value]])]),o("div",D,[e[3]||(e[3]=o("label",{for:"password"},[o("span",{class:"detail-icon"},"ðŸ”’"),f(" ContraseÃ±a ")],-1)),b(o("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>i.value=r),type:"password",id:"password",class:"login-input",required:"",placeholder:"Password"},null,512),[[w,i.value]])]),e[4]||(e[4]=o("button",{type:"submit",class:"login-button"},[o("span",{class:"button-icon"},"âœ¨"),f(" Entrar ")],-1))],32),o("div",F,[e[6]||(e[6]=o("p",null,"Â¿AÃºn no formas parte del cÃ­rculo?",-1)),m(p,{to:"/registro",class:"register-link"},{default:O(()=>e[5]||(e[5]=[o("span",{class:"button-icon"},"ðŸŒŒ",-1),f(" Unirse al Misterio ")])),_:1,__:[5]})])])])]))}}}),R=j(H,[["__scopeId","data-v-26d565bc"]]),K=Object.freeze(Object.defineProperty({__proto__:null,default:R},Symbol.toStringTag,{value:"Module"}));export{R as L,K as a,q as u};
